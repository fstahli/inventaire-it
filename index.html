<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Inventaire IT</title>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Inventaire IT">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2c3e50">
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjE4MCIgaGVpZ2h0PSIxODAiIHJ4PSI0MCIgZmlsbD0iIzJjM2U1MCIvPjx0ZXh0IHg9IjkwIiB5PSIxMTAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSI4MCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPvCfk6Y8L3RleHQ+PC9zdmc+">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHJ4PSI4IiBmaWxsPSIjMmMzZTUwIi8+PHRleHQgeD0iMTYiIHk9IjIyIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7wn5OmPC90ZXh0Pjwvc3ZnPg==">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #2c3e50;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: -1px;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.2em;
            position: relative;
            z-index: 1;
        }
        
        .main-content {
            padding: 40px;
        }
        
        .status-indicator {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 0.85em;
            font-weight: 600;
            z-index: 1000;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .status-online {
            background: rgba(46, 204, 113, 0.9);
            color: white;
            box-shadow: 0 8px 32px rgba(46, 204, 113, 0.3);
        }
        
        .status-syncing {
            background: rgba(241, 196, 15, 0.9);
            color: white;
            box-shadow: 0 8px 32px rgba(241, 196, 15, 0.3);
        }
        
        .status-offline {
            background: rgba(231, 76, 60, 0.9);
            color: white;
            box-shadow: 0 8px 32px rgba(231, 76, 60, 0.3);
        }
        
        .sync-info {
            background: linear-gradient(135deg, #e8f5e8, #d5f4e6);
            border: 2px solid #27ae60;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            font-size: 0.95em;
            color: #27ae60;
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.1);
        }
        
        .config-section {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 2px solid #f39c12;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(243, 156, 18, 0.1);
        }
        
        .config-section h3 {
            color: #f39c12;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .collapsible-section {
            margin-bottom: 30px;
        }
        
        .section-toggle {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 16px 25px;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            text-align: left;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.2);
        }
        
        .section-toggle:hover {
            background: linear-gradient(135deg, #2980b9, #1f5f8b);
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(52, 152, 219, 0.3);
        }
        
        .section-toggle.active {
            background: linear-gradient(135deg, #27ae60, #219a52);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.2);
        }
        
        .toggle-icon {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }
        
        .toggle-icon.rotated {
            transform: rotate(180deg);
        }
        
        .section-content {
            display: none;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 0 0 12px 12px;
            border: 2px solid #e9ecef;
            border-top: none;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .form-group input, .form-group select {
            padding: 15px 18px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
            font-family: inherit;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.1);
            transform: translateY(-1px);
        }
        
        .config-input {
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
            font-size: 0.9em;
            border: 2px solid #f39c12;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: inherit;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
        }
        
        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #2980b9, #1f5f8b);
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(52, 152, 219, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60, #219a52);
            color: white;
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
        }
        
        .btn-success:hover:not(:disabled) {
            background: linear-gradient(135deg, #219a52, #1e8449);
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(39, 174, 96, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 10px 15px;
            font-size: 0.85em;
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.3);
        }
        
        .btn-danger:hover:not(:disabled) {
            background: linear-gradient(135deg, #c0392b, #a93226);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(231, 76, 60, 0.4);
        }
        
        .btn-quantity {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 6px;
            width: 28px;
            height: 28px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .btn-quantity:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(52, 152, 219, 0.4);
        }
        
        .btn-quantity.decrease {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .btn-quantity.decrease:hover {
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.4);
        }
        
        .btn-quantity.increase {
            background: linear-gradient(135deg, #27ae60, #219a52);
        }
        
        .btn-quantity.increase:hover {
            box-shadow: 0 3px 10px rgba(39, 174, 96, 0.4);
        }
        
        .actions {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 40px;
            justify-content: center;
        }
        
        .inventory-container {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }
        
        .inventory-header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px;
            text-align: center;
            font-weight: 600;
            font-size: 1.3em;
            position: relative;
        }
        
        .inventory-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 25px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border: 1px solid #e9ecef;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .inventory-grid {
            display: grid;
            gap: 1px;
            background: #e9ecef;
        }
        
        .grid-header {
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 130px 100px 100px;
            background: #34495e;
            color: white;
            font-weight: 600;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .grid-header > div {
            padding: 20px 15px;
            display: flex;
            align-items: center;
        }
        
        .grid-row {
            display: grid;
            grid-template-columns: 2fr 2fr 1fr 130px 100px 100px;
            background: white;
            transition: all 0.2s ease;
            cursor: move;
            user-select: none;
        }
        
        .grid-row:hover {
            background: #f8f9fa;
            transform: translateX(5px);
            box-shadow: 5px 0 15px rgba(0,0,0,0.1);
        }
        
        .grid-row.dragging {
            opacity: 0.6;
            transform: rotate(2deg);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .grid-row.drag-over {
            border-top: 3px solid #3498db;
            margin-top: 3px;
        }
        
        .grid-cell {
            padding: 20px 15px;
            display: flex;
            align-items: center;
            font-size: 0.95em;
            border-right: 1px solid #ecf0f1;
        }
        
        .grid-cell:last-child {
            border-right: none;
            justify-content: center;
        }
        
        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
            min-width: 120px;
        }
        
        .quantity-display {
            font-weight: 700;
            font-size: 1em;
            color: #2c3e50;
            min-width: 40px;
            width: 40px;
            text-align: center;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 6px 4px;
            transition: all 0.2s ease;
            cursor: pointer;
            margin: 0 2px;
        }
        
        .quantity-display:hover {
            background: #f8f9fa;
            border-color: #3498db;
        }
        
        .quantity-display:focus {
            outline: none;
            background: white;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
            cursor: text;
        }
        
        .drag-handle {
            color: #bdc3c7;
            font-size: 1.2em;
            margin-right: 10px;
            cursor: move;
            transition: color 0.2s ease;
        }
        
        .drag-handle:hover {
            color: #3498db;
        }
        
        .state-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .state-neuf {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .state-bon {
            background: #cce5ff;
            color: #004085;
            border: 1px solid #99ccff;
        }
        
        .state-moyen {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .state-defaillant {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .empty-state {
            text-align: center;
            padding: 80px 40px;
            color: #7f8c8d;
            background: white;
        }
        
        .empty-icon {
            font-size: 5em;
            margin-bottom: 25px;
            opacity: 0.3;
        }
        
        .empty-state h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .search-box {
            padding: 25px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }
        
        .search-input {
            width: 100%;
            padding: 15px 20px 15px 50px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1em;
            background: white url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%236c757d' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E") no-repeat 18px center;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.1);
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2em;
            }
            
            .main-content {
                padding: 25px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .actions {
                justify-content: stretch;
            }
            
            .actions .btn {
                flex: 1;
            }
            
            .status-indicator {
                position: static;
                margin-bottom: 20px;
                text-align: center;
            }
            
            .inventory-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            /* Affichage mobile en cartes au lieu de grille */
            .inventory-grid {
                display: block;
            }
            
            .grid-header {
                display: none;
            }
            
            .grid-row {
                display: block;
                background: white;
                margin-bottom: 15px;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                border: 1px solid #e9ecef;
                position: relative;
            }
            
            .grid-row:hover {
                transform: none;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            }
            
            .grid-cell {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 8px 0;
                border-right: none;
                border-bottom: 1px solid #f1f3f4;
            }
            
            .grid-cell:last-child {
                border-bottom: none;
                justify-content: center;
                margin-top: 10px;
            }
            
            .grid-cell::before {
                content: attr(data-label) ":";
                font-weight: 600;
                color: #7f8c8d;
                font-size: 0.8em;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                min-width: 80px;
            }
            
            .grid-cell[data-label="Type & Marque"]::before {
                content: "ÉQUIPEMENT:";
            }
            
            .grid-cell[data-label="Actions"]::before {
                content: "";
            }
            
            /* Réorganiser l'affichage Type & Marque sur mobile */
            .grid-cell[data-label="Type & Marque"] {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .grid-cell[data-label="Type & Marque"] > div {
                display: flex;
                align-items: center;
                width: 100%;
            }
            
            .drag-handle {
                position: absolute;
                top: 10px;
                right: 10px;
                font-size: 1em;
            }
            
            /* Améliorer les contrôles de quantité sur mobile */
            .quantity-controls {
                display: flex;
                align-items: center;
                gap: 8px;
                justify-content: center;
                flex-wrap: nowrap;
            }
            
            .mobile-quantity-stack {
                display: flex;
                flex-direction: column;
                gap: 2px;
            }
            
            .btn-quantity {
                width: 26px;
                height: 26px;
                font-size: 11px;
                font-weight: bold;
                border-radius: 4px;
            }
            
            .quantity-display {
                min-width: 35px;
                width: 35px;
                font-size: 1em;
                padding: 5px 2px;
                text-align: center;
                margin: 0 3px;
                border: 2px solid #e9ecef;
                border-radius: 6px;
                background: white;
            }
            
            /* Badge d'état plus petit sur mobile */
            .state-badge {
                padding: 4px 8px;
                font-size: 0.7em;
            }
            
            /* Bouton de suppression plus petit */
            .btn-danger {
                padding: 6px 10px;
                font-size: 0.8em;
            }
            
            /* Section d'ajout optimisée pour mobile */
            .section-toggle {
                font-size: 1em;
                padding: 12px 20px;
            }
            
            .section-content {
                padding: 20px;
            }
            
            /* Statistiques sur 3 colonnes au lieu de 2 */
            .inventory-stats {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
                padding: 15px;
            }
            
            .stat-card {
                padding: 12px;
            }
            
            .stat-number {
                font-size: 1.5em;
            }
            
            .stat-label {
                font-size: 0.7em;
            }
            
            /* Barre de recherche mobile */
            .search-box {
                padding: 15px;
            }
            
            .search-input {
                padding: 12px 15px 12px 40px;
                font-size: 16px; /* Évite le zoom sur iOS */
            }
        }
    </style>
</head>
<body>
    <!-- Indicateur de statut -->
    <div id="status-indicator" class="status-indicator status-offline">
        🔄 Initialisation...
    </div>
    
    <div class="container">
        <div class="header">
            <h1>📦 Inventaire IT Pro</h1>
            <p>Gestion intelligente des stocks • Synchronisation cloud</p>
        </div>
        
        <div class="main-content">
            <!-- Section de configuration GitHub (masquée automatiquement) -->
            <div id="config-section" class="config-section" style="display: none;">
                <h3>⚙️ Configuration GitHub</h3>
                <p style="margin-bottom: 20px; color: #856404;">Configuration automatique activée pour fstahli/inventaire-it</p>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Nom du repository</label>
                        <input type="text" id="github-repo" class="config-input" value="inventaire-it" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Token d'accès GitHub</label>
                    <input type="password" id="github-token" class="config-input" value="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" readonly>
                    <small style="color: #27ae60; margin-top: 8px; display: block;">
                        ✅ Configuration automatique activée
                    </small>
                </div>
            </div>
            
            <div class="sync-info">
                <strong>🌟 Synchronisation GitHub activée !</strong><br>
                Vos données sont automatiquement sauvegardées et synchronisées entre tous vos appareils en temps réel.
            </div>
            
            <!-- Section pliable pour ajouter des articles -->
            <div class="collapsible-section">
                <button class="section-toggle" id="add-toggle" onclick="toggleSection('add-section')">
                    ➕ Ajouter un nouvel équipement
                    <span class="toggle-icon" id="add-icon">🔽</span>
                </button>
                <div class="section-content" id="add-section">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="type">Type d'équipement</label>
                            <select id="type">
                                <option value="Écran">Écran</option>
                                <option value="Souris">Souris</option>
                                <option value="Clavier">Clavier</option>
                                <option value="Ordinateur">Ordinateur</option>
                                <option value="Imprimante">Imprimante</option>
                                <option value="Câble">Câble</option>
                                <option value="Casque">Casque</option>
                                <option value="Webcam">Webcam</option>
                                <option value="Adaptateur">Adaptateur</option>
                                <option value="custom">➕ Nouvel équipement</option>
                            </select>
                        </div>
                        
                        <div class="form-group" id="custom-type-group" style="display: none;">
                            <label for="custom-type">Nom du nouvel équipement</label>
                            <input type="text" id="custom-type" placeholder="Ex: Tablette graphique">
                        </div>
                        
                        <div class="form-group">
                            <label for="marque">Marque</label>
                            <input type="text" id="marque" placeholder="Ex: Dell, HP, Logitech... (optionnel)">
                        </div>
                        
                        <div class="form-group">
                            <label for="modele">Modèle</label>
                            <input type="text" id="modele" placeholder="Ex: OptiPlex 7090 (optionnel)">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="etat">État</label>
                            <select id="etat">
                                <option value="Neuf">Neuf</option>
                                <option value="Bon">Bon</option>
                                <option value="Moyen">Moyen</option>
                                <option value="Défaillant">Défaillant</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="quantite">Quantité</label>
                            <input type="number" id="quantite" placeholder="1" min="1" value="1">
                        </div>
                        
                        <div class="form-group">
                            <label for="notes">Notes</label>
                            <input type="text" id="notes" placeholder="Commentaires optionnels">
                        </div>
                    </div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" id="add-btn" onclick="ajouterItem()">✨ Ajouter à l'inventaire</button>
                    </div>
                </div>
            </div>
            
            <div class="actions">
                <button class="btn btn-success" onclick="exporterPDF()">📄 Exporter en PDF</button>
                <button class="btn btn-primary" id="sync-btn" onclick="synchroniser()">🔄 Synchroniser</button>
            </div>
            
            <!-- Inventaire principal -->
            <div class="inventory-container">
                <div class="inventory-header">
                    📋 Inventaire des équipements
                </div>
                
                <div class="inventory-stats" id="inventory-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="total-references">0</div>
                        <div class="stat-label">Références</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-items">0</div>
                        <div class="stat-label">Articles</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-value">0</div>
                        <div class="stat-label">En bon état</div>
                    </div>
                </div>
                
                <div class="search-box">
                    <input type="text" class="search-input" id="search-input" placeholder="Rechercher dans l'inventaire..." onkeyup="filtrerInventaire()">
                </div>
                
                <div id="inventory-container">
                    <div class="empty-state">
                        <div class="empty-icon">📦</div>
                        <h3>Aucun équipement dans l'inventaire</h3>
                        <p>Ajoutez votre premier équipement pour commencer la gestion des stocks</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Types d'équipements par défaut
        let typesEquipements = [
            'Écran', 'Souris', 'Clavier', 'Ordinateur', 'Imprimante', 
            'Câble', 'Casque', 'Webcam', 'Adaptateur'
        ];

        // Variables globales
        let inventaire = [];
        let idCounter = 1;
        let githubConfig = null;
        let isConfigured = false;
        let inventaireFiltré = [];

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            loadGitHubConfig();
            
            // Gérer le type personnalisé
            document.getElementById('type').addEventListener('change', function() {
                const customGroup = document.getElementById('custom-type-group');
                if (this.value === 'custom') {
                    customGroup.style.display = 'block';
                } else {
                    customGroup.style.display = 'none';
                }
            });
        });

        function loadGitHubConfig() {
            // Configuration automatique avec vos paramètres
            githubConfig = {
                username: 'fstahli',
                repo: 'inventaire-it',
                token: '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'
            };
            
            // Sauvegarder la configuration
            localStorage.setItem('github-config', JSON.stringify(githubConfig));
            isConfigured = true;
            
            // Masquer la section de configuration
            document.getElementById('config-section').style.display = 'none';
            
            // Tester la connexion GitHub (gère ses propres statuts)
            chargerDepuisGitHub();
            
            // Charger les types personnalisés
            chargerTypesEquipements();
            mettreAJourListeTypes();
        }

        function chargerTypesEquipements() {
            const savedTypes = localStorage.getItem('types-equipements');
            if (savedTypes) {
                try {
                    const customTypes = JSON.parse(savedTypes);
                    // Fusionner avec les types par défaut sans doublons
                    typesEquipements = [...new Set([...typesEquipements, ...customTypes])];
                } catch (e) {
                    console.error('Erreur chargement types:', e);
                }
            }
        }

        function sauvegarderTypesEquipements() {
            // Sauvegarder uniquement les types personnalisés (pas ceux par défaut)
            const typesDefaut = ['Écran', 'Souris', 'Clavier', 'Ordinateur', 'Imprimante', 'Câble', 'Casque', 'Webcam', 'Adaptateur'];
            const typesPersonnalises = typesEquipements.filter(type => !typesDefaut.includes(type));
            localStorage.setItem('types-equipements', JSON.stringify(typesPersonnalises));
        }

        function mettreAJourListeTypes() {
            const selectType = document.getElementById('type');
            // Conserver la sélection actuelle
            const currentValue = selectType.value;
            
            // Vider et reconstruire la liste
            selectType.innerHTML = '';
            
            // Ajouter tous les types (triés alphabétiquement)
            const typesTries = [...typesEquipements].sort();
            typesTries.forEach(type => {
                const option = document.createElement('option');
                option.value = type;
                option.textContent = type;
                selectType.appendChild(option);
            });
            
            // Ajouter l'option pour nouveau type
            const optionCustom = document.createElement('option');
            optionCustom.value = 'custom';
            optionCustom.textContent = '➕ Nouvel équipement';
            selectType.appendChild(optionCustom);
            
            // Restaurer la sélection si elle existe encore
            if (typesTries.includes(currentValue)) {
                selectType.value = currentValue;
            }
        }

        function saveGitHubConfig() {
            const username = document.getElementById('github-username').value.trim();
            const repo = document.getElementById('github-repo').value.trim();
            const token = document.getElementById('github-token').value.trim();

            if (!username || !repo || !token) {
                alert('Veuillez remplir tous les champs');
                return;
            }

            githubConfig = { username, repo, token };
            localStorage.setItem('github-config', JSON.stringify(githubConfig));
            isConfigured = true;
            document.getElementById('config-section').style.display = 'none';
            updateStatusIndicator('online');
            synchroniser();
        }

        function updateStatusIndicator(status) {
            const indicator = document.getElementById('status-indicator');
            switch (status) {
                case 'online':
                    indicator.className = 'status-indicator status-online';
                    indicator.innerHTML = '✅ Synchronisé avec GitHub';
                    break;
                case 'syncing':
                    indicator.className = 'status-indicator status-syncing';
                    indicator.innerHTML = '🔄 Synchronisation...';
                    break;
                case 'offline':
                    indicator.className = 'status-indicator status-offline';
                    indicator.innerHTML = '📱 Mode local';
                    break;
            }
        }

        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId);
            const toggle = document.getElementById(sectionId.replace('-section', '-toggle'));
            const icon = document.getElementById(sectionId.replace('-section', '-icon'));
            
            if (content.style.display === 'none' || content.style.display === '') {
                content.style.display = 'block';
                toggle.classList.add('active');
                icon.classList.add('rotated');
                icon.textContent = '🔼';
            } else {
                content.style.display = 'none';
                toggle.classList.remove('active');
                icon.classList.remove('rotated');
                icon.textContent = '🔽';
            }
        }

        async function chargerDepuisGitHub() {
            if (!isConfigured) return;
            
            updateStatusIndicator('syncing');
            
            try {
                const url = `https://api.github.com/repos/${githubConfig.username}/${githubConfig.repo}/contents/inventaire.json`;
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `token ${githubConfig.token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    const content = JSON.parse(decodeURIComponent(escape(atob(data.content))));
                    inventaire = content.items || [];
                    inventaire.forEach(item => {
                        if (!item.quantite) item.quantite = 1;
                        // Nettoyer complètement toutes les valeurs "Sans marque"
                        if (item.marque === 'Sans marque' || item.marque === 'sans marque') {
                            item.marque = '';
                        }
                        if (item.modele === 'Sans modèle' || item.modele === 'sans modèle') {
                            item.modele = '';
                        }
                    });
                    if (inventaire.length > 0) {
                        idCounter = Math.max(...inventaire.map(item => item.id)) + 1;
                    }
                    afficherInventaire();
                    updateStatusIndicator('online');
                    // Re-sauvegarder pour nettoyer définitivement
                    sauvegarderInventaire();
                } else if (response.status === 404) {
                    await sauvegarderVersGitHub();
                } else {
                    throw new Error(`Erreur GitHub: ${response.status}`);
                }
            } catch (error) {
                console.error('Erreur chargement GitHub:', error);
                chargerDepuisLocal();
                updateStatusIndicator('offline');
            }
        }

        async function sauvegarderVersGitHub() {
            if (!isConfigured) return;
            
            updateStatusIndicator('syncing');
            
            try {
                const url = `https://api.github.com/repos/${githubConfig.username}/${githubConfig.repo}/contents/inventaire.json`;
                
                let sha = null;
                try {
                    const existingResponse = await fetch(url, {
                        headers: {
                            'Authorization': `token ${githubConfig.token}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    if (existingResponse.ok) {
                        const existingData = await existingResponse.json();
                        sha = existingData.sha;
                    }
                } catch (e) {
                    // Fichier n'existe pas
                }

                const data = {
                    items: inventaire,
                    lastUpdate: Date.now(),
                    version: '2.0'
                };

                const payload = {
                    message: `Mise à jour inventaire IT - ${new Date().toLocaleString('fr-FR')}`,
                    content: btoa(unescape(encodeURIComponent(JSON.stringify(data, null, 2)))),
                    committer: {
                        name: 'Inventaire IT Pro',
                        email: 'inventaire@app.local'
                    }
                };

                if (sha) payload.sha = sha;

                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${githubConfig.token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    updateStatusIndicator('online');
                } else {
                    throw new Error(`Erreur sauvegarde: ${response.status}`);
                }
            } catch (error) {
                console.error('Erreur sauvegarde GitHub:', error);
                updateStatusIndicator('offline');
            }
        }

        function chargerDepuisLocal() {
            try {
                const saved = localStorage.getItem('inventaire-it');
                if (saved) {
                    inventaire = JSON.parse(saved);
                    inventaire.forEach(item => {
                        if (!item.quantite) item.quantite = 1;
                        // Nettoyer complètement toutes les valeurs "Sans marque"
                        if (item.marque === 'Sans marque' || item.marque === 'sans marque') {
                            item.marque = '';
                        }
                        if (item.modele === 'Sans modèle' || item.modele === 'sans modèle') {
                            item.modele = '';
                        }
                    });
                    if (inventaire.length > 0) {
                        idCounter = Math.max(...inventaire.map(item => item.id)) + 1;
                    }
                    afficherInventaire();
                    // Re-sauvegarder pour nettoyer définitivement
                    sauvegarderInventaire();
                }
            } catch (e) {
                console.error('Erreur chargement local:', e);
            }
        }

        async function synchroniser() {
            if (isConfigured) {
                await chargerDepuisGitHub();
            } else {
                alert('Veuillez d\'abord configurer GitHub');
            }
        }

        async function ajouterItem() {
            let type = document.getElementById('type').value;
            const customType = document.getElementById('custom-type').value.trim();
            const marque = document.getElementById('marque').value.trim();
            const modele = document.getElementById('modele').value.trim();
            const etat = document.getElementById('etat').value;
            const notes = document.getElementById('notes').value.trim();
            const quantite = parseInt(document.getElementById('quantite').value) || 1;

            if (type === 'custom') {
                if (!customType) {
                    alert('Veuillez renseigner le nom du nouvel équipement');
                    return;
                }
                type = customType;
                
                // Ajouter le nouveau type à la liste s'il n'existe pas déjà
                if (!typesEquipements.includes(type)) {
                    typesEquipements.push(type);
                    sauvegarderTypesEquipements();
                    mettreAJourListeTypes();
                    // Sélectionner automatiquement le nouveau type
                    document.getElementById('type').value = type;
                }
            }

            // Si ni marque ni modèle ne sont renseignés, demander au moins l'un des deux
            if (!marque && !modele) {
                alert('Veuillez renseigner au moins la marque ou le modèle');
                return;
            }

            // Vérifier si un article similaire existe déjà
            const articleExistant = inventaire.find(item => 
                item.type === type && 
                (item.marque || '').toLowerCase() === marque.toLowerCase() &&
                (item.modele || '').toLowerCase() === modele.toLowerCase() &&
                item.etat === etat
            );

            if (articleExistant) {
                if (confirm(`Un article similaire existe déjà (Quantité: ${articleExistant.quantite}). Voulez-vous augmenter sa quantité de ${quantite} ?`)) {
                    articleExistant.quantite += quantite;
                    if (notes) articleExistant.notes = notes;
                    articleExistant.timestamp = Date.now();
                    await sauvegarderInventaire();
                    afficherInventaire();
                    viderFormulaire();
                }
                return;
            }

            const nouvelItem = {
                id: idCounter++,
                type,
                marque: marque && marque.trim() && marque.trim() !== 'Sans marque' ? marque.trim() : '',
                modele: modele && modele.trim() ? modele.trim() : '',
                etat,
                notes: notes && notes.trim() ? notes.trim() : '',
                quantite,
                timestamp: Date.now()
            };

            inventaire.push(nouvelItem);
            await sauvegarderInventaire();
            afficherInventaire();
            viderFormulaire();
        }

        async function updateQuantite(id, nouvelleQuantite) {
            const quantite = parseInt(nouvelleQuantite);
            if (isNaN(quantite) || quantite < 1) {
                afficherInventaire(); // Restaurer la valeur précédente
                return;
            }

            const item = inventaire.find(i => i.id === id);
            if (!item) return;

            item.quantite = quantite;
            item.timestamp = Date.now();
            await sauvegarderInventaire();
            updateStatistics();
        }

        // Variables pour le drag & drop
        let draggedElement = null;
        let draggedItemId = null;

        function handleDragStart(e) {
            draggedElement = e.target;
            draggedItemId = parseInt(e.target.dataset.itemId);
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.target.outerHTML);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            
            const targetRow = e.target.closest('.grid-row');
            if (targetRow && targetRow !== draggedElement) {
                // Enlever la classe drag-over de tous les éléments
                document.querySelectorAll('.grid-row').forEach(row => {
                    row.classList.remove('drag-over');
                });
                targetRow.classList.add('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            
            const targetRow = e.target.closest('.grid-row');
            if (!targetRow || targetRow === draggedElement) return;
            
            const targetItemId = parseInt(targetRow.dataset.itemId);
            
            // Réorganiser l'array inventaire
            const draggedIndex = inventaire.findIndex(item => item.id === draggedItemId);
            const targetIndex = inventaire.findIndex(item => item.id === targetItemId);
            
            if (draggedIndex !== -1 && targetIndex !== -1) {
                // Supprimer l'élément de sa position actuelle
                const [draggedItem] = inventaire.splice(draggedIndex, 1);
                // L'insérer à la nouvelle position
                inventaire.splice(targetIndex, 0, draggedItem);
                
                // Sauvegarder et réafficher
                sauvegarderInventaire();
                afficherInventaire();
            }
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            document.querySelectorAll('.grid-row').forEach(row => {
                row.classList.remove('drag-over');
            });
            draggedElement = null;
            draggedItemId = null;
        }

        async function modifierQuantite(id, changement) {
            const item = inventaire.find(i => i.id === id);
            if (!item) return;

            const nouvelleQuantite = (item.quantite || 1) + changement;
            
            if (nouvelleQuantite <= 0) {
                if (confirm('La quantité sera de 0. Voulez-vous supprimer cet article ?')) {
                    await supprimerItem(id);
                }
                return;
            }

            item.quantite = nouvelleQuantite;
            item.timestamp = Date.now();
            await sauvegarderInventaire();
            afficherInventaire();
        }

        async function supprimerItem(id) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cet élément ?')) {
                inventaire = inventaire.filter(item => item.id !== id);
                await sauvegarderInventaire();
                afficherInventaire();
            }
        }

        async function sauvegarderInventaire() {
            try {
                localStorage.setItem('inventaire-it', JSON.stringify(inventaire));
            } catch (e) {
                console.error('Erreur sauvegarde locale:', e);
            }

            if (isConfigured) {
                await sauvegarderVersGitHub();
            }
        }

        function filtrerInventaire() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            inventaireFiltré = inventaire.filter(item => 
                item.type.toLowerCase().includes(searchTerm) ||
                (item.marque && item.marque.toLowerCase().includes(searchTerm)) ||
                (item.modele && item.modele.toLowerCase().includes(searchTerm)) ||
                item.etat.toLowerCase().includes(searchTerm) ||
                (item.notes && item.notes.toLowerCase().includes(searchTerm))
            );
            afficherInventaire();
        }

        function afficherInventaire() {
            const container = document.getElementById('inventory-container');
            const itemsToShow = inventaireFiltré.length > 0 || document.getElementById('search-input').value ? inventaireFiltré : inventaire;
            
            // Mettre à jour les statistiques
            updateStatistics();

            if (itemsToShow.length === 0) {
                const searchValue = document.getElementById('search-input').value;
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">${searchValue ? '🔍' : '📦'}</div>
                        <h3>${searchValue ? 'Aucun résultat trouvé' : 'Aucun équipement dans l\'inventaire'}</h3>
                        <p>${searchValue ? 'Essayez avec d\'autres mots-clés' : 'Ajoutez votre premier équipement pour commencer'}</p>
                    </div>
                `;
                return;
            }

            let html = `
                <div class="inventory-grid">
                    <div class="grid-header">
                        <div>Type & Marque</div>
                        <div>Modèle</div>
                        <div>État</div>
                        <div>Quantité</div>
                        <div>Notes</div>
                        <div>Actions</div>
                    </div>
            `;

            itemsToShow.forEach((item, index) => {
                // Affichage différent pour mobile et desktop
                const isMobile = window.innerWidth <= 768;
                const quantityControls = `
                    <div class="quantity-controls">
                        <button onclick="modifierQuantite(${item.id}, -1)" class="btn-quantity decrease">-</button>
                        <input type="number" 
                               class="quantity-display" 
                               value="${item.quantite || 1}" 
                               min="1"
                               onchange="updateQuantite(${item.id}, this.value)"
                               onblur="this.style.cursor='pointer'"
                               onclick="this.style.cursor='text'; this.select()">
                        <button onclick="modifierQuantite(${item.id}, 1)" class="btn-quantity increase">+</button>
                    </div>
                `;

                html += `
                    <div class="grid-row" 
                         draggable="true" 
                         data-item-id="${item.id}"
                         ondragstart="handleDragStart(event)"
                         ondragover="handleDragOver(event)"
                         ondrop="handleDrop(event)"
                         ondragend="handleDragEnd(event)">
                        <div class="grid-cell" data-label="Type & Marque">
                            <div style="display: flex; align-items: center;">
                                <span class="drag-handle">⋮⋮</span>
                                <div>
                                    <div style="font-weight: 600; color: #2c3e50;">${item.type}</div>
                                    <div style="color: #7f8c8d; font-size: 0.9em;">${item.marque && item.marque.trim() ? item.marque : '-'}</div>
                                </div>
                            </div>
                        </div>
                        <div class="grid-cell" data-label="Modèle">${item.modele || '-'}</div>
                        <div class="grid-cell" data-label="État">
                            <span class="state-badge state-${item.etat.toLowerCase()}">${item.etat}</span>
                        </div>
                        <div class="grid-cell" data-label="Quantité">
                            ${quantityControls}
                        </div>
                        <div class="grid-cell" data-label="Notes">${item.notes || '-'}</div>
                        <div class="grid-cell" data-label="Actions">
                            <button class="btn btn-danger" onclick="supprimerItem(${item.id})">🗑️</button>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;
        }

        function updateStatistics() {
            const totalReferences = inventaire.length;
            const totalItems = inventaire.reduce((sum, item) => sum + (item.quantite || 1), 0);
            const bonEtat = inventaire.filter(item => item.etat === 'Neuf' || item.etat === 'Bon')
                .reduce((sum, item) => sum + (item.quantite || 1), 0);

            document.getElementById('total-references').textContent = totalReferences;
            document.getElementById('total-items').textContent = totalItems;
            document.getElementById('total-value').textContent = bonEtat;
        }

        function viderFormulaire() {
            // Ne pas réinitialiser le type s'il vient d'être ajouté
            const currentType = document.getElementById('type').value;
            if (currentType === 'custom' || !typesEquipements.includes(currentType)) {
                document.getElementById('type').selectedIndex = 0; // Premier type de la liste
            }
            
            document.getElementById('custom-type').value = '';
            document.getElementById('custom-type-group').style.display = 'none';
            document.getElementById('marque').value = '';
            document.getElementById('modele').value = '';
            document.getElementById('etat').value = 'Neuf';
            document.getElementById('notes').value = '';
            document.getElementById('quantite').value = '1';
        }

        function exporterPDF() {
            if (inventaire.length === 0) {
                alert('Aucun élément à exporter');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4'); // Portrait pour plus d'articles

            // Configuration des couleurs
            const primaryColor = [44, 62, 80];
            const secondaryColor = [52, 73, 94];
            const accentColor = [52, 152, 219];

            // En-tête compact
            doc.setFillColor(...primaryColor);
            doc.rect(0, 0, 210, 20, 'F'); // Plus petit en hauteur
            
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(18); // Plus petit
            doc.setFont('helvetica', 'bold');
            doc.text('INVENTAIRE IT', 15, 13);

            // Statistiques compactes à droite de l'en-tête
            const totalItems = inventaire.reduce((sum, item) => sum + (item.quantite || 1), 0);
            const totalReferences = inventaire.length;
            const bonEtat = inventaire.filter(item => item.etat === 'Neuf' || item.etat === 'Bon')
                .reduce((sum, item) => sum + (item.quantite || 1), 0);

            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold'); // Statistiques en gras
            doc.text(`${totalReferences} ref. | ${totalItems} art. | ${bonEtat} en bon etat`, 135, 8);
            
            // Date compacte
            const now = new Date();
            const dateStr = now.toLocaleDateString('fr-FR');
            const timeStr = now.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text(`${dateStr} ${timeStr}`, 155, 15);

            // Préparation des données avec optimisation de l'espace
            const donnees = inventaire.map(item => {
                // Combinaison intelligent type + marque pour économiser l'espace
                let equipement = item.type;
                if (item.marque && item.marque.trim()) {
                    equipement += ` (${item.marque})`;
                }
                
                // Modèle tronqué si trop long
                let modele = item.modele || '-';
                if (modele.length > 20) {
                    modele = modele.substring(0, 17) + '...';
                }
                
                // Notes tronquées si trop longues
                let notes = item.notes || '-';
                if (notes.length > 25) {
                    notes = notes.substring(0, 22) + '...';
                }
                
                // États raccourcis
                const etatsRaccourcis = {
                    'Neuf': 'Neuf',
                    'Bon': 'Bon', 
                    'Moyen': 'Moy.',
                    'Défaillant': 'Def.'
                };

                return {
                    equipement: equipement,
                    modele: modele,
                    etat: etatsRaccourcis[item.etat] || item.etat,
                    quantite: item.quantite || 1,
                    notes: notes.replace(/é/g, 'e').replace(/è/g, 'e').replace(/à/g, 'a').replace(/ç/g, 'c')
                };
            });

            // Définition des colonnes optimisées
            const colonnes = [
                { header: 'Equipement', dataKey: 'equipement' },
                { header: 'Modele', dataKey: 'modele' },
                { header: 'Etat', dataKey: 'etat' },
                { header: 'Qte', dataKey: 'quantite' },
                { header: 'Notes', dataKey: 'notes' }
            ];

            // Tableau principal avec optimisations
            doc.autoTable({
                columns: colonnes,
                body: donnees,
                startY: 25, // Plus haut sur la page
                margin: { left: 10, right: 10 }, // Marges réduites
                styles: { 
                    fontSize: 9, // Taille lisible conservée
                    cellPadding: 3, // Padding correct pour la lisibilité
                    lineColor: [230, 230, 230],
                    lineWidth: 0.3,
                    overflow: 'linebreak', // Retour à la ligne automatique
                    valign: 'middle',
                    fontStyle: 'normal'
                },
                headStyles: { 
                    fillColor: primaryColor,
                    textColor: [255, 255, 255],
                    fontSize: 10,
                    fontStyle: 'bold',
                    halign: 'center',
                    cellPadding: 4
                },
                alternateRowStyles: { 
                    fillColor: [248, 249, 250] 
                },
                columnStyles: {
                    0: { cellWidth: 65, halign: 'left', fontStyle: 'bold' },   // Équipement en gras
                    1: { cellWidth: 38, halign: 'left' },   // Modèle
                    2: { cellWidth: 18, halign: 'center', fontStyle: 'bold' }, // État en gras
                    3: { cellWidth: 14, halign: 'center', fontStyle: 'bold' }, // Quantité en gras
                    4: { cellWidth: 45, halign: 'left' }    // Notes
                },
                rowPageBreak: 'avoid', // Évite de couper les lignes entre les pages
                showHead: 'everyPage', // En-tête sur chaque page
                didDrawCell: function(data) {
                    // Colorier les états avec des couleurs plus subtiles
                    if (data.column.dataKey === 'etat') {
                        const etat = data.cell.raw;
                        let color;
                        switch(data.cell.text[0]) {
                            case 'Neuf': color = [212, 237, 218]; break;
                            case 'Bon': color = [204, 229, 255]; break;
                            case 'Moy.': color = [255, 243, 205]; break;
                            case 'Def.': color = [248, 215, 218]; break;
                            default: color = [255, 255, 255];
                        }
                        doc.setFillColor(...color);
                        doc.rect(data.cell.x, data.cell.y, data.cell.width, data.cell.height, 'F');
                        
                        // Texte centré
                        doc.setTextColor(44, 62, 80);
                        doc.setFontSize(9);
                        doc.setFont('helvetica', 'bold'); // État en gras
                        doc.text(data.cell.text[0], data.cell.x + data.cell.width / 2, data.cell.y + data.cell.height / 2 + 1, { align: 'center' });
                    }
                },
                didDrawPage: function(data) {
                    // Pied de page sur chaque page
                    const pageHeight = doc.internal.pageSize.getHeight();
                    const pageWidth = doc.internal.pageSize.getWidth();
                    
                    doc.setFillColor(...secondaryColor);
                    doc.rect(0, pageHeight - 12, pageWidth, 12, 'F');
                    
                    doc.setTextColor(255, 255, 255);
                    doc.setFontSize(8);
                    doc.setFont('helvetica', 'bold');
                    doc.text('Inventaire IT Pro', 10, pageHeight - 6);
                    
                    // Numéro de page
                    const pageNum = data.pageNumber;
                    const totalPages = doc.internal.getNumberOfPages();
                    doc.setFont('helvetica', 'normal');
                    doc.text(`Page ${pageNum}/${totalPages}`, pageWidth - 30, pageHeight - 6);
                }
            });

            // Résumé en fin de document si plus d'une page
            if (doc.internal.getNumberOfPages() > 1) {
                doc.addPage();
                
                // En-tête résumé
                doc.setFillColor(...accentColor);
                doc.rect(0, 0, 210, 15, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.text('RESUME EXECUTIF', 15, 10);

                // Statistiques détaillées
                doc.setTextColor(...primaryColor);
                doc.setFontSize(12);
                doc.setFont('helvetica', 'normal');
                
                let y = 30;
                doc.text(`Total des references : ${totalReferences}`, 20, y);
                y += 8;
                doc.text(`Total des articles : ${totalItems}`, 20, y);
                y += 8;
                doc.text(`Articles en bon etat : ${bonEtat} (${Math.round(bonEtat/totalItems*100)}%)`, 20, y);
                y += 15;

                // Répartition par état
                doc.setFont('helvetica', 'bold');
                doc.text('Repartition par etat :', 20, y);
                y += 10;
                
                doc.setFont('helvetica', 'normal');
                const etats = ['Neuf', 'Bon', 'Moyen', 'Défaillant'];
                etats.forEach(etat => {
                    const count = inventaire.filter(item => item.etat === etat)
                        .reduce((sum, item) => sum + (item.quantite || 1), 0);
                    if (count > 0) {
                        doc.text(`- ${etat} : ${count} articles (${Math.round(count/totalItems*100)}%)`, 25, y);
                        y += 6;
                    }
                });

                y += 10;

                // Top 5 des équipements les plus nombreux
                doc.setFont('helvetica', 'bold');
                doc.text('Top 5 des equipements :', 20, y);
                y += 10;
                
                const equipementStats = {};
                inventaire.forEach(item => {
                    const key = item.type;
                    if (!equipementStats[key]) {
                        equipementStats[key] = 0;
                    }
                    equipementStats[key] += item.quantite || 1;
                });
                
                const topEquipements = Object.entries(equipementStats)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 5);
                
                doc.setFont('helvetica', 'normal');
                topEquipements.forEach(([type, count], index) => {
                    doc.text(`${index + 1}. ${type} : ${count} articles`, 25, y);
                    y += 6;
                });
            }

            // Sauvegarder avec un nom personnalisé
            const fileName = `Inventaire-IT-${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}.pdf`;
            doc.save(fileName);
        }

        // Démarrage de l'application
        window.onload = function() {
            loadGitHubConfig();
        };
    </script>
</body>
</html>                    <div class="form-group">
                        <label>Nom du repository</label>
                        <input type="text" id="github-repo" class="config-input" value="inventaire-it" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Token d'accès GitHub</label>
                    <input type="password" id="github-token" class="config-input" value="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" readonly>
                    <small style="color: #27ae60; margin-top: 8px; display: block;">
                        ✅ Configuration automatique activée
                    </small>
                </div>
            </div>
